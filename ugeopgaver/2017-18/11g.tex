\documentclass[a4paper,12pt]{article}

\input{setup}
\newcommand{\sbl}{Simple Jack}
\newcommand{\chess}{Simple Chess}

\title{Programmering og Problemløsning\\Datalogisk Institut,
  Københavns Universitet\\Uge(r)seddel 11 - group opgave}
\author{Jon Sporring and Christina Lioma}
\date{18.\ december -- 10.\ januar.\\Afleveringsfrist: onsdag d. 10. januar kl. 22:00}

\begin{document}
\maketitle

I denne periode skal I arbejde i grupper. 
%Regler for individuelle afleveringsopgaver er beskrevet i "`Noter, links, software m.m."'$\rightarrow$"`Generel information om opgaver"'. 
Formålet er at arbejde med:
\begin{itemize}
\item Inheritance
\item UML diagrams
\end{itemize}

Opgaverne for denne uge er delt i øve- og afleveringsopgaver. 

Øve-opgaverne er:
\begin{enumerate}[label=11ø.\arabic*,start=0]

\item Write a \texttt{Person} class with data attributes for a person's name, address, and telephone number. Next, write a class named \texttt{Customer} that is a subclass of the \texttt{Person} class. The \texttt{Customer} class should have a data attribute for a customer number and a Boolean data attribute indicating whether the customer wishes to be on a mailing list. Demonstrate an instance of the \texttt{Customer} class in a simple program.
  
\item Write an \texttt{Employee} class that keeps data attributes for the following pieces of information: 
  \begin{itemize}
  \item Employee name
  \item Employee number
  \end{itemize}
  Next, write a class named \texttt{ProductionWorker} that is a subclass of the \texttt{Employee} class. The \texttt{ProductionWorker} class should keep data attributes for the following information:
  \begin{itemize}
  \item Shift number (an integer, such as 1 or 2)
  \item Hourly pay rate
  \end{itemize}
  The workday is divided into two shifts: day and night. The shift attribute will hold an integer value representing the shift that the employee works. The day shift is shift 1 and the night shift is shift 2. Write the appropriate methods for each class.
  
  Once you have written the classes, write a program that creates an object of the \texttt{ProductionWorker} class and prompts the user to enter data for each of the object's data attributes. Store the data in the object and then use the object's methods to retrieve it and display it on the screen.
  
\item Extend the previous exercise as follows: Let a shift supervisor be a salaried employee who supervises a shift. In addition to salary, the shift supervisor earns a yearly bonus when his or her shift meets production goals. Write a \texttt{ShiftSupervisor} class that is a subclass of the \texttt{Employee} class you created in the previous exercise. The \texttt{ShiftSupervisor} class should keep a data attribute for the annual salary and a data attribute for the annual production bonus that a shift supervisor has earned. Demonstrate the class by writing a program that uses a \texttt{ShiftSupervisor} object.
  
\item \textbf{(Extra difficult).} Considering that production during night shifts is reduced by 5\% compared to production during day shifts, and that the hourly pay rate during night shifts is double the hourly pay rate during day shifts, compute the best possible worker \& shift allocation over the period of 12 months. You need to think how to measure productivity and salary cost, and then find their best tradeoff in the period of 12 months.
  
\item Cheetahs, antelopes and wildebeests are among the world's fastest mammals. This exercise asks you to simulate a race between them. You are not asked to simulate their movement on some plane, but only some of the conditions that affect their speed when running a certain distance. 
  
  Produce a UML diagram representing the following.
  
  Your base class is called \texttt{Animal} and has these attributes: 
  \begin{itemize}
  \item The amount of food needed daily (measured in kilograms)
  \item The weight of the animal (measured in kilograms)
  \item The maximum speed of the animal (measured in kilometres per hour)
  \item The current speed of the animal (measured in kilometres per hour)
  \end{itemize}
  The \texttt{Animal} class should have a primary constructor that takes two arguments: the animal's weight and the animal's maximum speed. The \texttt{Animal} class should also have an additional constructor that takes as input only the animal's maximum speed and generates the animal's weight randomly within the range of 70 - 300 kg. The \texttt{Animal} class should have two methods:
  \begin{itemize}
  \item The first method should set the current speed of the animal proportionately to its food intake and maximum speed as follows: if the animal eats 100\% of the amount of food it needs daily, the animal's current speed should be its maximum speed; if the animal eats 50\% of the amount of food it needs daily, the animal's current speed should be 50\% of its maximum speed, and so on.
  \item The second method should set the amount of food needed daily proportionately to the animal's weight as follows: the animal should eat half its own weight in food every day (if the animal weighs 50 kg, it should eat 25kg of food daily).
  \end{itemize}
  
  
  Create a subclass \texttt{Carnivore} that inherits everything from class \texttt{Animal}, and modifies the second method as follows: the animal should eat 8\% of its own weight in food every day.
  
  Create a subclass \texttt{Herbivore} that inherits everything from class \texttt{Animal}, and modifies the second method as follows: the animal should eat 40\% of its own weight in food every day.
  
  Create an instance of \texttt{Carnivore} called \texttt{cheetah} and two instances of \texttt{Herbivore} called \texttt{antelope, wildebeest}. Set their weight and maximum speed to:
  \begin{itemize}
  \item cheetah: 50kg, 114km/hour
  \item antelope: 50kg, 95km/hour
  \item wildebeest: 200kg, 80km/hour
  \end{itemize}
  
  Generate a random percentage between 1 - 100\% (inclusive) separately for each instance. This random percentage represents the amount of food the animal eats with respect to the amount of food it needs daily. E.g., if you generate the random percentage 50\% for the antelope, this means that the antelope will eat 50\% of the amount it should have eaten (as decided by the second method). 
  
  For each instance, display the random percentage you generated, how much food each animal consumed, how much food it should have consumed, and how long it took for the animal to cover 10km. 
  Repeat this 3 times (generating different random percentages each time), and declare winner the animal that was fastest on average all three times. If there is a draw, repeat and recompute until there is a clear winner.
  
  Test all methods. %You should include a UML diagram, comment your code and describe in max. 2 pages (excluding the UML diagram) what your program does and how you have tested the methods. 
  
  \textbf{Optional extra:} repeat the race without passing as input argument the weight of each animal (i.e. letting the additional constructor generate a different random weight for each instance).
  
\item Du skal implementere en udvidelse til \sbl som indeholder en omstrukturering af nogle af klasserne, samt indførelse af en række nye strategier. Du skal simulere nogle \sbl spil hvor du afprøver forskellige strategier, for at afgøre
  hvilken strategi som lader til at være den bedste. \\ \\
  Implement\'{e}r super-klassen \texttt{Player}, og klasserne \texttt{Dealer}, \texttt{Human} og \texttt{AI} som nedarver fra \texttt{Player.} \texttt{Player} skal indeholde attributter og metoder som implementerer den fælles funktionalitet
  som alle tre typer "spillere" har, f.eks. en metode som vælger "Hit" eller "Stand". \\ \\
  Implement\'{e}r super-klassen \texttt{Strategy}, samt en klasse for hver af følgende strategier, som alle nedarver fra \texttt{Strategy}
  \begin{enumerate}
  \item Vælg altid "Hit", medmindre summen af egne kort kan være 15 eller over, ellers vælg "Stand".
  \item Vælg altid "Hit", medmindre summen af egne kort kan være 17 eller over, ellers vælg "Stand".
  \item Vælg altid "Hit", medmindre summen af egne kort kan være 19 eller over, ellers vælg "Stand".
  \item Vælg tilfældigt mellem "Hit" og "Stand". Hvis "Hit" er valgt, trækkes et kort og der vælges igen tilfældigt mellem
    "Hit" os "Stand" osv.
  \item Følg strategi 2. hvis \'{e}t af egne kort er et Es, ellers følg strategi 1.
  \end{enumerate}
  Simul\'{e}r 3000 spil \sbl med 5 \texttt{AI} spillere som følger de 5 ovenstående strategier.
  Dealer skal følge strategi 2. 
  Konklud\'{e}r hvilken af strategierne som lader til at være bedst. \\ \\
  Du skal også
  \begin{itemize}
  \item Beskrive designet som et UML-diagram
  \item Lave Unittests
  \item Kommentere ny kode jævnfør kommentarstandarden for F\#
  \end{itemize}
  
\item Produce a UML diagram for each of the above exercises.
  
\end{enumerate}

Afleveringsopgaven er:

Sporring, ``Learning to program with F\#'', 2017, Chapter~21.4 describes a simplified version of Chess with only Kings and Rooks, and which we here will call \chess, and which is implemented in 3 files: \lstinline{chess.fs}, \lstinline{pieces.fs}, and \lstinline{chessApp.fsx}. In this assignment you are to work with this implementation, and the assignment consists of the following design and programming tasks:
\begin{enumerate}[label=11g.\arabic*,start=0]
\item Produce a UML diagram describing the design presented of \chess\ in the book.
\item The implementation of \lstinline{availableMoves} for the King is flawed, since the method will list a square as available, even though it can be hit by an opponents piece at next turn. Correct \lstinline{availableMoves}, such that threatened squares no longer are part of the list of vacant squares. If as a consequence you update the design w.r.t.\ your UML diagram, then provide an updated UML diagram.
\item Extend the implementation with a class \lstinline{Player} and two derived classes \lstinline{Human} and \lstinline{Computer}. The derived classes must have a method \lstinline{nextMove}, which returns a legal movement as a codestring or the string ``quit''.  A codestring is a string of the name of two squares separated by a space. E.g., if the white king is placed at a4, and a5 is an available move for the king, then a legal codestring for moving the king to a5 is ``a4 a5''. The player can be either a human or the computer. If the player is human, then the codestring is obtained by a text dialogue with the user. If the player is the computer, then the codestring must be constructed from a random selection of available move of one of its pieces.
\item Extend the implementation with a class \lstinline{Game}, which includes a method \lstinline{run}, and which allows two players to play a game. The class must be instantiated with two player objects either human or computer, and \lstinline{run} must loop through each turn and ask each player object for their next move, until one of the players quits by typing ``quit''.
\item Extend \lstinline{Player} with an artificial intelligence (AI), which simulate all possible series of moves at least $n \geq 0$ turns ahead or until a King is strikken. Each series should be given a fitness, and the AI should pick the move, which is the beginning of a series with the largest fitness. If there are several moves which have series with same fitness, then the AI should pick randomly among them. The fitness number must be calculated as the sum of the fitness of each move. A move, which does not strike any pieces gets value 0, if an opponent's rook is strikken, then the move has value 3. If the opponent strikes the player's rook, then the value of the move is -3. The king has in the same manner value $\pm100$. As an example, consider the series of 2 moves starting from \Cref{fig:init}, and it is black's turn to move.
\begin{figure}
  \centering
  \newgame
  \loadgame{kingsGame}
  \subfigure[Initial position\label{fig:init}]{\showboard}
  \loadgame{kingsGame2}
  \subfigure[b5 c5\label{fig:move1}]{\showboard}
  \loadgame{kingsGame3}
  \subfigure[b2 b4\label{fig:move2}]{\showboard}
%  \mainline{1.b2 b5}
%  \mainline{1.e4 e5 2. Nf3 Nc6 3.Bb5}
  \caption{Starting at the left and moving white rook to b4.}
  \label{fig:chessKingsGame}
\end{figure}
The illustrated series is \lstinline{["b5 b6"; "b2 b4"]}, the fitness of the corresponding moves are \lstinline{[0;-3]}, and the fitness of the series is \lstinline{-3}. Another series among all possible is \lstinline{["b5 b6"; "b2 c2"]}, which has fitness \lstinline{0}. Thus, of the moves considered,  \lstinline{"b5 b6"} has the maximum fitness of \lstinline{0} and is the top candidate for a move by the AI. Note that a rook has at maximum 14 possible squares to move to, and a king 8, so for a game where each player has a rook and a king each, then the number of series looking $n$ turns ahead is $\mathcal{O}(22^n)$.
\item Make an extended UML diagram showing the final design including all the extending classes.
\end{enumerate}

\subsection*{Krav til opgavebesvarelsen}
You must make a program consisting of one or more F\# files, that extends \chess\ as described above, and you must write a small report. The hand-in must consists of the report on pdf-format, one or more fsharp source files, and a single compiled \lstinline[language=console]{exe} file, which can be run using \lstinline[language=console]{mono} command. The hand-in must also give the list of console commands used to compile the program. Besides the requirements described in the previous section, the program must be documented using the F\# documentation standard, and the program must be tested with both a black- and white-box testing. The report must be written in either English or Danish, typeset using \LaTeX, and as its main parts include the sections Introduction (Introduktion), Problem analysis and design (Problemanalyse og design), Program description (Programbeskrivelse), Testing (Afprøvning), and Discussion and Conclusion (Diskussion og Konklusion) as shown in \texttt{rapport.tex}. As appendix the report must be include a User Guide (Brugervejledning). The report excluding frontpage and appendix should be no larger than 10 pages.
 
\flushright God fornøjelse.
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
